---
import { Image } from "astro:assets";
import MainLayout from "../layouts/MainLayout.astro";
import siteConfig from "../site.config";
import coverImage from "../assets/images/pixeltrue-space-discovery.svg";

const pageTitle = `${siteConfig.title} | Kontak`;
const pageDescription =
  siteConfig.contactInfo?.text ??
  "Hubungi Twotworial untuk konsultasi & layanan drafter furniture.";
const siteBase = Astro.site ?? siteConfig.website;
const canonicalUrl = new URL("/contact", siteBase).href;

// ===== JSON-LD =====
const orgSameAs =
  siteConfig.contactInfo?.socialProfiles?.map((s) => s.href).filter(Boolean) ?? [];

const contactEmail = siteConfig.contactInfo?.email?.email ?? "hi@twotworial.com";

const contactSchema = {
  "@context": "https://schema.org",
  "@type": "ContactPage",
  name: pageTitle,
  description: pageDescription,
  url: canonicalUrl,
  publisher: {
    "@type": "Organization",
    name: siteConfig.title,
    url: new URL("/", siteBase).href,
    logo: {
      "@type": "ImageObject",
      url: new URL(siteConfig.image?.src ?? "/TwotworialSQ.webp", siteBase).href
    },
    sameAs: orgSameAs,
    contactPoint: [
      {
        "@type": "ContactPoint",
        contactType: "customer support",
        email: contactEmail
      }
    ]
  }
};

const contactSchemaStr = JSON.stringify(contactSchema).replace(/</g, "\\u003c");
---

<MainLayout
  activePage="contact"
  pageTitle={pageTitle}
  description={pageDescription}
  image={coverImage.src}
  breadcrumbTitle="Kontak"
>
  <!-- JSON-LD -->
  <script type="application/ld+json" is:inline set:html={contactSchemaStr}></script>

  <div class="page-content">
    <!-- Ganti kelas Sigmar ke utilitas Inter -->
    <h1 class="text-4xl font-bold leading-tight text-balance">
      {siteConfig.contactInfo?.title ?? "Kontak"}
    </h1>

    <Image
      src={coverImage}
      alt="Ilustrasi amplop surat di luar angkasa"
      width={400}
      height={300}
      loading="eager"
      decoding="async"
      class="mx-auto mb-8 rounded-3xl grayscale saturate-200"
      sizes="(max-width: 768px) 85vw, 400px"
    />

    <div class="flex flex-col gap-4">
      <p class="text-left">
        {siteConfig.contactInfo?.text}
      </p>

      <p class="text-left">
        {siteConfig.contactInfo?.email?.text}<br />
        <a
          href={siteConfig.contactInfo?.email?.href ?? `mailto:${contactEmail}`}
          class="underline underline-offset-2"
        >
          {contactEmail}
        </a>
      </p>

      {siteConfig.contactInfo?.socialProfiles?.length ? (
        <div class="flex flex-col gap-2 text-left">
          <p class="font-semibold">Social Profiles:</p>
          <ul class="flex flex-wrap gap-x-4 gap-y-2">
            {siteConfig.contactInfo.socialProfiles.map((profile) => (
              <li>
                <a
                  href={profile.href}
                  rel="noopener noreferrer external"
                  target="_blank"
                  class="hover:underline underline-offset-2"
                >
                  {profile.text}
                </a>
              </li>
            ))}
          </ul>
        </div>
      ) : null}
    </div>
  </div>
</MainLayout>
