---
import { getCollection } from "astro:content";
import MainLayout from "../layouts/MainLayout.astro";
import siteConfig from "../site.config";
import { sortItemsByDateDesc, withBase } from "../utils/helpers";
import PostCardPreview from "../components/PostCardPreview.astro";
import Button from "../components/Button.astro";

// Pakai ?url â†’ string
import heroImageUrl from "../assets/images/pixeltrue-space-discovery.svg?url";

const allPosts = (await getCollection("blogs")).sort(sortItemsByDateDesc);

const pageTitle =
  siteConfig.title + " | Konsultan & Drafter Furniture - Costing, Draftlist, & Gambar Kerja";
const pageDescription =
  "Drafter & konsultan furniture untuk UMKM/manufaktur: gambar kerja profesional, costing & COGS, draftlist, serta artikel praktik harian bengkel.";
---

<MainLayout activePage="home" pageTitle={pageTitle} description={pageDescription} image={siteConfig.image?.src ?? "/TwotworialSQ.webp"}>
  <section class="jumbo-banner w-full my-12 px-4">
    <div class="grid grid-cols-1 items-center gap-8 sm:grid-cols-2">
      <div>
        {siteConfig.hero?.eyebrowText && (
          <span class="tag kanit-light inline-block rounded-full border border-gray-500 px-2 py-0 text-xs">
            {siteConfig.hero.eyebrowText}
          </span>
        )}
        <h1 class="sigmar-ff text-balance leading-tight">{siteConfig.hero?.title}</h1>
        <p class="kanit-regular text-balance text-xs sm:text-base">{siteConfig.hero?.text}</p>

        <div class="mt-3 flex flex-wrap items-center gap-x-2 gap-y-3 text-xs sm:mt-8 sm:text-base">
          {siteConfig.hero?.actions?.map((a, i) => (
            <Button href={a.href} class={i === 0 ? "space-btn-filled" : "space-btn-outlined"}>{a.text}</Button>
          ))}
        </div>
      </div>

      <div class="justify-self-center sm:justify-self-end">
        <img
          src={heroImageUrl}
          alt="Ilustrasi astronot: eksplorasi ide & tooling furniture"
          width="400"
          height="300"
          loading="eager"
          decoding="async"
          class="h-auto max-w-full"
          sizes="(max-width: 640px) 85vw, 400px"
        />
      </div>
    </div>
  </section>

  <section class="page-content">
    <div id="posts" class="flex w-full flex-col items-center justify-center">
      <h2 class="sigmar-ff text-balance">Artikel Terbaru</h2>
      <div class="flex flex-col gap-8 max-w-full text-left">
        {allPosts.slice(0, siteConfig.recentPostLimit).map((post) => <PostCardPreview post={post} />)}
      </div>
      <Button href={withBase("/blog")} class="space-btn-filled mt-8">Lihat Semua Artikel</Button>
    </div>
  </section>
</MainLayout>
