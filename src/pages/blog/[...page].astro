---
import type { GetStaticPathsOptions, Page } from "astro";
import { type CollectionEntry, getCollection } from "astro:content";
import Pagination from "../../components/Pagination.astro";
import { sortItemsByDateDesc } from "../../utils/helpers";
import MainLayout from "../../layouts/MainLayout.astro";
import siteConfig from "../../site.config";
import PostCardPreview from "../../components/PostCardPreview.astro";

export async function getStaticPaths({ paginate }: GetStaticPathsOptions) {
  const blogs = (await getCollection("blogs")).sort(sortItemsByDateDesc);
  return paginate(blogs, { pageSize: siteConfig.postsPerPage || 2 });
}

type Props = { page: Page<CollectionEntry<"blogs">> };
const { page } = Astro.props as Props;
const allPosts = page.data;
---

<MainLayout activePage="blog" pageTitle={siteConfig.title + " | Blog Archive"}>
  <div class="page-content py-8 text-center">
    <h1 class="sigmar-ff">Blog</h1>
    {siteConfig.blog?.description && (
      <p class="font-light text-balance">{siteConfig.blog?.description}</p>
    )}

    <!-- GRID wrapper: 1 kolom di mobile, 2 kolom di desktop -->
    <div class="mx-auto mb-4 max-w-6xl grid grid-cols-1 gap-6 md:gap-8 lg:grid-cols-2 text-left text-sm sm:text-base">
      {allPosts.map((post) => <PostCardPreview post={post} />)}
    </div>

    <Pagination page={page} class="mb-16 sm:mb-24" />
  </div>
</MainLayout>
