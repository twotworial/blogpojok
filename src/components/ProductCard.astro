---
// src/components/ProductCard.astro
interface Image { src: string; alt?: string }
interface Props {
  title: string;
  slug: string;
  price: number;
  currency?: string;
  excerpt?: string;
  images: Image[];
}
const { title, slug, price, currency = "IDR", excerpt, images } = Astro.props as Props;

function fmt(n: number, cur: string) {
  try { return new Intl.NumberFormat("id-ID", { style:"currency", currency: cur }).format(n) }
  catch { return `Rp ${n.toLocaleString("id-ID")}` }
}

const cover = images?.[0];
const href = `/products/${slug}/`;
---
<article class="rounded-3xl border p-4 sm:p-5">
  {cover && (
    <a href={href} aria-label={title}>
      <img
        src={cover.src}
        alt={cover.alt ?? title}
        class="mb-3 h-52 w-full rounded-2xl object-cover"
        loading="lazy"
        decoding="async"
      />
    </a>
  )}

  <h3 class="mb-1 text-lg font-semibold">
    <a href={href} class="hover:underline">{title}</a>
  </h3>

  {excerpt && <p class="mb-3 text-sm opacity-80 line-clamp-2">{excerpt}</p>}

  <div class="flex items-center justify-between">
    <span class="font-medium">{fmt(price, currency)}</span>
    <a href={href} class="button-link space-btn-outlined text-sm px-4 py-1.5">Lihat</a>
  </div>
</article>
